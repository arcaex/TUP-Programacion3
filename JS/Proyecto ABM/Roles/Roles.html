<!DOCTYPE html>
<html style="font-size: 16px;" lang="es-AR">

<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <meta name="keywords" content="">
  <meta name="description" content="">
  <meta name="page_type" content="np-template-header-footer-from-plugin">
  <title>Roles</title>
  <link rel="stylesheet" href="nicepage.css" media="screen">
  <link rel="stylesheet" href="Roles.css" media="screen">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
  <meta name="generator" content="Nicepage 3.6.2, nicepage.com">
  <link id="u-theme-google-font" rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
  <meta property="og:title" content="Roles">
  <meta property="og:type" content="website">
  <meta name="theme-color" content="#478ac9">
  <link rel="canonical" href="index.html">
  <meta property="og:url" content="index.html">
</head>

<body class="u-body">
  <script>
    $(document).ready(function () {

        localStorage.getItem("token") ?  null : window.location.replace("../Login/login.html");
        // curl --location --request POST 'http://kiwicode.tech:3000/auth' \ --header 'Content-Type: application/json' \ --data-raw '{ "mail":"graciajorge.sist@gmail.com", "password": "123123" }' 
        $("#cerrarSesion").click(
        function(){
            localStorage.removeItem("token");
            window.location.replace("../Login/login.html");
        });

        function getRoles(){
            $.ajax({
                url: "http://kiwicode.tech:3000/roles",
                type: "GET",
                headers: {
                    Authorization : localStorage.getItem("token")
                },
                data: { },
                success: function (result) {
                    $("#lista").empty();
                    result.forEach(element => {
                      $("#lista").append('<div class="u-border-2 u-border-palette-1-base u-container-style u-list-item u-repeater-item"><div class="u-container-layout u-similar-container u-container-layout-1"><h2 class="u-text u-text-default u-text-palette-1-base u-text-1">(ID: ' + element.id_rol + ' ) - Rol : ' + element.descripcion + '<button onclick="borrar('+ element.id_rol + ')" id="borrar-' + element.id_rol + '">Borrar</button> </h2></div></div>');
                    });
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.responseJSON.data.errMessage);
                }
            });
        };

                // curl --location --request POST 'http://kiwicode.tech:3000/roles' \ --header 'Content-Type: application/json' \ --data-raw '{ "descripcion": "Rolprueba" }' 
        $("#save").click(
        function(){
            var descripcion = $("#descripcion").val();
            $.ajax({
                url: "http://kiwicode.tech:3000/roles",
                type: "POST",
                headers: {
                    Authorization : localStorage.getItem("token")
                },
                data: { "descripcion" : descripcion},
                success: function (result) {
                    alert("¡Se guardó Correctamente!");
                    getRoles();
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert(XMLHttpRequest.responseJSON.data.errMessage);
                }
            });
        });

        getRoles();

    });
</script>

  <header class="u-clearfix u-header u-palette-1-base u-header" id="sec-1073">
    <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
      <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
        <div class="menu-collapse"
          style="font-size: 1rem; letter-spacing: 0px; font-weight: 700; text-transform: uppercase;">
          <a class="u-button-style u-custom-active-border-color u-custom-active-color u-custom-border u-custom-border-color u-custom-borders u-custom-hover-border-color u-custom-hover-color u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link"
            href="#" style="padding: 1px 0px; font-size: calc(1em + 2px);">
            <svg>
              <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
            </svg>
            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
              <defs>
                <symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;">
                  <rect y="1" width="16" height="2"></rect>
                  <rect y="7" width="16" height="2"></rect>
                  <rect y="13" width="16" height="2"></rect>
                </symbol>
              </defs>
            </svg>
          </a>
        </div>
        <div class="u-custom-menu u-nav-container">
          <!-- Menu -->
          <ul class="u-nav u-spacing-2 u-unstyled u-nav-1">
            <li class="u-nav-item"><a
                class="u-border-2 u-border-active-white u-border-hover-grey-50 u-button-style u-nav-link u-text-active-white u-text-hover-grey-90 u-text-white"
                href="Roles.html" style="padding: 10px 20px;">Roles</a>
            </li>
            <li class="u-nav-item">
              <a class="u-border-2 u-border-active-white u-border-hover-grey-50 u-button-style u-nav-link u-text-active-white u-text-hover-grey-90 u-text-white"
                style="padding: 10px 20px;" id="cerrarSesion">Cerrar Sesión</a>
            </li>
          </ul>
        </div>
        <div class="u-custom-menu u-nav-container-collapse">
          <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
            <div class="u-sidenav-overflow">
              <div class="u-menu-close"></div>
              <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                <li class="u-nav-item"><a class="u-button-style u-nav-link" href="Roles.html">Roles</a>
                </li>
                <li class="u-nav-item"><a class="u-button-style u-nav-link"  id="cerrarSesion">Cerrar Sesión</a>
                </li>
              </ul>
            </div>
          </div>
          <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
        </div>
      </nav>
    </div>
  </header>
  <section class="u-align-center u-clearfix u-section-1" id="sec-32b3">
    <div class="u-clearfix u-sheet u-sheet-1">
      <div class="u-align-center u-form u-form-1">
          <input type="hidden" id="siteId" name="siteId" value="78820216">
          <input type="hidden" id="pageId" name="pageId" value="88481225">
          <div class="u-form-group u-form-name">
            <label for="name-94fe" class="u-form-control-hidden u-label">Descripción</label>
            <input type="text" placeholder="Introduzca la Descripción del Rol" id="descripcion" name="descripcion"
              class="u-border-1 u-border-grey-30 u-input u-input-rectangle u-white" required>
          </div>
          <div class="u-align-center u-form-group u-form-submit">
            <a href="#" class="u-btn u-btn-submit u-button-style" id="save">Guardar</a>
          </div>
      </div>
    </div>
  </section>
  <section class="u-clearfix u-section-2" id="sec-dc6b">
    <div class="u-clearfix u-sheet u-sheet-1">
      <div class="u-list u-repeater u-list-1" id="lista"></div>
    </div>
  </section>

</body>

</html>